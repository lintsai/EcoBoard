# Issue #10 完整使用流程說明

## 🎯 核心改進：消除重複建立與不完整 Review

### 問題根源
原本的設計在三個關鍵頁面只顯示「今日建立」的項目，導致：
1. **填寫工作項目** - 看不到昨天未完成的項目 → 重複建立
2. **站立會議 Review** - 看不到昨天未完成的項目 → 無法完整 review
3. **更新工作進度** - 只有這裡能看到未完成項目 ❌

---

## ✅ 新的完整流程

### 📋 1. 填寫工作項目（WorkItems.tsx）

**改進前**：
```
- 只顯示：今日新建的項目 (2個)
- 看不到：昨天未完成的「API 優化」
→ 結果：可能重複建立「API 優化」項目
```

**改進後**：
```
📊 今日工作項目 (2)
  ├─ 前端 UI 調整
  └─ 資料庫查詢優化

⚠️ 未完成項目 (3) [可展開/收合]
  ├─ API 優化 (11/10 建立)    [繼續此項目] 按鈕
  ├─ 單元測試補充 (11/09 建立) [繼續此項目] 按鈕  
  └─ 文檔更新 (11/08 建立)     [繼續此項目] 按鈕
```

**操作流程**：

#### 情況 A：繼續未完成項目
```
1. 早上打卡後，進入「填寫工作項目」
2. 看到「未完成項目」區塊
3. 點擊「API 優化」→「繼續此項目」
4. AI 加載之前的對話歷史
5. 與 AI 討論今天要做什麼
6. 點擊「新增今日進度」
7. ✅ 系統建立今日項目，標註「*(延續項目 #123)*」
```

#### 情況 B：建立全新項目
```
1. 直接與 AI 對話，描述新工作
2. 點擊「儲存為新工作項目」
3. ✅ 建立今日新項目
```

---

### 👥 2. 站立會議 Review（StandupReview.tsx）

**改進前**：
```
張三
  └─ 今日工作項目 (1)
      └─ 前端 UI 調整
  
問題：看不到張三昨天未完成的「API 優化」
```

**改進後**：
```
張三
  └─ 今日工作項目 (1)
      └─ 前端 UI 調整
  
  └─ ⚠️ 未完成項目 (2) [可展開/收合]
      ├─ API 優化 (11/10 建立) 
      └─ 單元測試 (11/09 建立)

統計卡片：
  📊 今日項目: 5
  ⚠️ 未完成項目: 8  ← 新增
```

**AI 分析改進**：
```
點擊「AI 分析工作分配」時：
- 分析範圍 = 今日項目 + 未完成項目
- AI 會特別關注：
  ✓ 哪些項目已延遲多天
  ✓ 哪些成員有過多未完成項目
  ✓ 建議優先級調整
```

---

### 🔄 3. 更新工作進度（UpdateWork.tsx）

**維持原有功能**：
```
已完善支援今日和未完成項目的更新
```

---

## 📊 完整使用場景

### 場景：跨日期項目追蹤

#### Day 1 (11/10) - 建立項目
```
早上 9:00  → 填寫工作項目
            創建：「API 性能優化」
            
上午 10:00 → 站立會議 Review
            Manager 看到：張三今日項目 (1)
            
下班 18:00 → 更新工作進度
            狀態：進行中 (完成 30%)
```

#### Day 2 (11/11) - 繼續項目
```
早上 9:00  → 填寫工作項目
            看到「未完成項目」區塊
            ├─ API 性能優化 (11/10)
            
            選擇：「繼續此項目」
            與 AI 討論今天計劃
            點擊：「新增今日進度」
            
            結果：
            ├─ 今日項目 (1): API 性能優化今日進度
            └─ 未完成項目 (1): API 性能優化 (原項目)
            
上午 10:00 → 站立會議 Review  
            Manager 看到：
            ├─ 今日項目 (1)
            │   └─ API 性能優化今日進度
            └─ 未完成項目 (1) ⚠️
                └─ API 性能優化 (11/10 建立)
            
            AI 分析提示：
            "張三持續追蹤 API 優化項目，已進行 2 天"
            
下班 18:00 → 更新工作進度
            今日項目：API 優化今日進度
            狀態：已完成 ✅
            
            原項目：API 性能優化
            狀態：已完成 ✅
            
            → 兩個都完成，從未完成列表移除
```

#### Day 3 (11/12) - 總結生成
```
下班 18:00 → 生成每日總結
            
            總結包含：
            ✓ 11/12 建立的所有項目
            ✓ 11/12 有更新的所有項目 (含 11/10, 11/11 建立的)
            
            特別標註：
            "API 性能優化 (11/10 建立，今日完成) - 跨 3 天完成"
```

---

## 🎨 UI 設計邏輯

### 顏色區分
| 類型 | 顏色 | 用途 |
|------|------|------|
| 今日項目 | 藍色 (#0066cc) | 今天新建的項目 |
| 未完成項目 | 橙色 (#f59e0b) | 之前建立未完成的項目 |
| 已完成 | 綠色 (#4caf50) | 完成的項目徽章 |
| 已取消 | 深灰 (#666) | 取消的項目徽章 |

### 展開/收合邏輯
```
[今日工作項目] - 預設展開
  ├─ 項目 1 ▼ - 點擊展開詳情
  └─ 項目 2 ▶

[⚠️ 未完成項目] - 預設展開（引起注意）
  ├─ 項目 A ▼ - 點擊展開詳情
  └─ 項目 B ▶ - [繼續此項目] 按鈕
```

---

## 🔄 狀態管理邏輯

### 未完成項目查詢條件
```sql
WHERE progress_status NOT IN ('completed', 'cancelled')
  AND checkin_date != today
```

**包含**：
- ✅ not_started (未開始)
- ✅ in_progress (進行中)
- ✅ blocked (受阻)

**排除**：
- ❌ completed (已完成)
- ❌ cancelled (已取消)
- ❌ 今日建立的項目（避免重複）

---

## 📈 數據流向

### 填寫工作項目
```
API 調用：
1. getTodayWorkItems(teamId)       → 今日項目
2. getIncompleteWorkItems(teamId)  → 未完成項目

顯示：
- 今日項目列表
- 未完成項目列表（可選擇繼續）

操作：
- 建立新項目 → createWorkItem()
- 繼續項目 → 新建今日項目 + 標註來源
```

### 站立會議 Review
```
API 調用：
1. getTodayTeamWorkItems(teamId)      → 團隊今日項目
2. getIncompleteTeamWorkItems(teamId) → 團隊未完成項目

顯示：
- 每個成員的今日項目
- 每個成員的未完成項目

AI 分析：
- 輸入 = 今日項目 + 未完成項目
- 輸出 = 完整的工作分析
```

### 每日總結
```
查詢邏輯：
WHERE team_id = $1 AND (
  checkin_date = today                    -- 今日建立
  OR EXISTS (                             -- 或今日有更新
    SELECT 1 FROM work_updates 
    WHERE work_item_id = wi.id 
      AND DATE(updated_at) = today
  )
)

結果：
- 包含所有今日有進展的項目
- 區分「今日新建」vs「跨日期追蹤」
```

---

## ✅ 優勢總結

### 1. 避免重複建立
- ✅ 用戶一眼看到未完成項目
- ✅ 可直接繼續，不會重複建立
- ✅ 保持項目歷史連貫性

### 2. 完整 Review
- ✅ 管理員看到團隊全貌
- ✅ AI 分析更準確
- ✅ 不遺漏任何進行中的工作

### 3. 更好的追蹤
- ✅ 跨日期項目清晰可見
- ✅ 每日總結包含所有進展
- ✅ 項目生命週期完整記錄

### 4. 狀態管理
- ✅ 5 種狀態涵蓋所有情況
- ✅ cancelled 明確表達「不做了」
- ✅ 未完成列表自動過濾

---

## 🧪 測試檢查清單

- [ ] Day 1 建立項目，未完成
- [ ] Day 2 填寫工作時能看到 Day 1 項目
- [ ] 點擊「繼續此項目」能載入歷史
- [ ] 新增今日進度成功
- [ ] 站立會議能看到今日+未完成項目
- [ ] AI 分析包含所有項目
- [ ] 更新狀態為完成後從未完成列表移除
- [ ] 更新狀態為取消後從未完成列表移除
- [ ] 每日總結包含跨日期更新的項目
- [ ] 管理員能看到團隊所有未完成項目

---

## 🎯 關鍵改進點

1. **三個頁面統一** ✅
   - 填寫工作項目
   - 站立會議 Review
   - 更新工作進度
   
2. **數據完整性** ✅
   - 顯示今日+未完成
   - AI 分析今日+未完成
   - 總結包含今日更新的所有項目

3. **用戶體驗** ✅
   - 視覺區分清晰
   - 操作邏輯直觀
   - 避免重複操作

4. **項目追蹤** ✅
   - 跨日期追蹤
   - 狀態變更記錄
   - 生命週期完整
