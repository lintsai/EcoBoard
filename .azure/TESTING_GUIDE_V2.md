# 用戶測試指南

## 開發服務器狀態
✅ 已啟動
- 後端: http://localhost:3000
- 前端: http://localhost:3001

## 測試前準備

### 1. 確認測試帳號
需要兩個帳號：
- **管理員帳號**: 在團隊中有 admin 角色
- **一般成員帳號**: 在團隊中有 member 角色

### 2. 清除瀏覽器快取
1. 開啟 http://localhost:3001
2. 按 F12 打開開發者工具
3. 在 Console 標籤查看調試訊息
4. 按 Ctrl+Shift+R 強制重新載入

---

## 測試項目

### 測試 1: 團隊管理 - 刪除和權限按鈕（問題 1 & 7）

**測試步驟**:
1. 以**管理員帳號**登入
2. 進入「團隊管理」頁面
3. 檢查 Console 中的調試訊息

**預期結果**:
```
=== Team Management Debug ===
Current user: { id: 1, username: "...", ... }
Current user ID: 1 "number"
Team members: [ { user_id: 1, role: "admin", ... }, ... ]
Current member: { user_id: 1, role: "admin", ... }
Is admin: true
===========================
```

**檢查項目**:
- [ ] Console 顯示 `Is admin: true`
- [ ] 頁面右上角可看到「刪除團隊」按鈕（紅色垃圾桶圖標）
- [ ] 成員列表中可看到「升級」或「降級」按鈕
- [ ] 按鈕可以點擊並執行功能

**如果看不到按鈕**:
1. 檢查 Console 的 `Is admin` 值
2. 檢查 `Current user ID` 和 `user_id` 的類型是否一致
3. 確認該帳號在數據庫中的 role 是 'admin'

---

### 測試 2: 填寫工作項目 - 版面布局（問題 2）

**測試步驟**:
1. 登入任何帳號
2. 完成打卡
3. 進入「填寫工作項目」頁面

**檢查項目**:
- [ ] 左側聊天區域和右側列表**不會重疊**
- [ ] 左側約佔 60%，右側約佔 40% 寬度
- [ ] 聊天區域有邊框和內距，看起來像一個獨立區塊
- [ ] 當聊天訊息很多時，聊天區域**可以滾動**
- [ ] 當工作項目很多時，右側列表**可以滾動**
- [ ] 整個頁面不會出現雙重滾動條
- [ ] 在不同瀏覽器寬度下都能正常顯示

**測試方法**:
1. 發送多條訊息，確認聊天區域可滾動
2. 創建多個工作項目，確認右側可滾動
3. 調整瀏覽器寬度，確認響應式布局正常

---

### 測試 3: 填寫工作項目 - AI 總結標題（問題 4）

**測試步驟**:
1. 在「填寫工作項目」頁面創建至少一個工作項目
2. 查看右側的「AI 總結」區塊

**檢查項目**:
- [ ] 可以看到 AI 總結區塊（藍色邊框）
- [ ] 標題旁邊有鉛筆圖標
- [ ] **點擊標題**可以進入編輯模式
- [ ] 編輯模式下顯示輸入框
- [ ] 修改標題後按 Enter 或失焦可以保存
- [ ] 標題修改後立即顯示新標題

---

### 測試 4: 填寫工作項目 - 編輯對話（問題 3）

⚠️ **此功能目前只是部分實現**

**測試步驟**:
1. 創建一個工作項目
2. 點擊該項目的「編輯」按鈕

**當前行為**:
- 聊天區域會顯示「正在編輯工作項目...」的提示
- 輸入框會預填該項目的內容
- 可以修改並更新項目

**限制**:
- ❌ 不會載入完整的對話歷史
- ❌ 無法看到建立該項目時的 AI 對話過程

**原因**: 數據庫 `work_items` 表沒有儲存 `session_id`

**解決方案**: 需要數據庫遷移（見下一節）

---

### 測試 5: 站立會議 - 工作項目查看（問題 5）

**測試步驟**:
1. 登入任何帳號
2. 進入「站立會議 Review」頁面
3. 檢查 Console 中的調試訊息

**預期 Console 輸出**:
```
=== Standup Review Debug ===
Team members: [ ... ]
Today checkins: [ ... ]
Work items: [ ... ]
Today date (client): "2025-11-05"
===========================
```

**檢查項目**:
- [ ] 可以看到團隊成員列表
- [ ] 每個成員顯示打卡狀態（已打卡/未打卡）
- [ ] 有工作項目的成員顯示「今日工作項目 (數量)」
- [ ] **點擊「今日工作項目」標題**可以展開/收合
- [ ] 展開時顯示工作項目內容和建立時間
- [ ] 箭頭圖標正確顯示狀態（上箭頭=展開，下箭頭=收合）

---

### 測試 6: 站立會議 - 打卡狀態（問題 6）

**測試步驟**:
1. 登入帳號 A
2. 完成打卡
3. 進入「站立會議 Review」頁面
4. 檢查自己的打卡狀態

**檢查項目**:
- [ ] 自己顯示為「已打卡」（綠色徽章）
- [ ] 顯示正確的打卡時間
- [ ] Console 中的 `Today checkins` 包含自己的記錄

**如果顯示不正確**:
1. 檢查 Console 的 `Today date (client)` 是否正確
2. 檢查 `Today checkins` 陣列中是否有自己的記錄
3. 比對 `user_id` 是否匹配

**後端檢查** (如果前端正確但顯示仍有問題):
```sql
-- 在 PostgreSQL 中執行
SELECT * FROM checkins 
WHERE checkin_date = CURRENT_DATE;

-- 檢查時區
SHOW timezone;
```

---

## 已知問題和限制

### 1. 編輯工作項目無法載入對話歷史 (問題 3)
**原因**: 數據庫結構限制
**影響**: 中等
**暫時方案**: 當作開始新對話使用
**永久方案**: 需要數據庫遷移

### 2. AI 總結標題不會持久化
**原因**: 設計決定（每次重新生成）
**影響**: 低
**行為**: 刷新頁面後標題恢復為預設值

### 3. 站立會議無法編輯工作項目
**原因**: 功能未實現
**影響**: 中等
**暫時方案**: 切換到「填寫工作項目」頁面編輯
**永久方案**: 可以添加此功能

---

## 調試技巧

### 查看 Console 日誌
1. 按 F12 打開開發者工具
2. 切換到 Console 標籤
3. 查找 `===` 開頭的調試訊息

### 查看 Network 請求
1. 按 F12 打開開發者工具
2. 切換到 Network 標籤
3. 刷新頁面
4. 查看 API 請求和響應

### 常見問題排查

**問題**: 按鈕看不到
- 檢查 Console 的 `Is admin` 值
- 確認 API 返回的 `role` 欄位
- 檢查 `user_id` 類型匹配

**問題**: 版面跑版
- 檢查瀏覽器 zoom 是否為 100%
- 嘗試不同瀏覽器寬度
- 查看 Console 是否有錯誤

**問題**: 打卡狀態不對
- 檢查 Console 的日期和時間
- 確認數據庫有打卡記錄
- 檢查時區設定

---

## 回報問題格式

如果發現問題，請提供：

1. **哪個測試項目**（例如：測試 1）
2. **實際看到的結果**（截圖 + Console 訊息）
3. **預期的結果**
4. **使用的帳號類型**（管理員/一般成員）
5. **瀏覽器和版本**

**範例**:
```
測試項目: 測試 1 - 團隊管理
實際結果: Console 顯示 "Is admin: false"，看不到刪除按鈕
預期結果: 應該顯示 "Is admin: true" 並可看到按鈕
帳號: testuser (應該是管理員)
瀏覽器: Chrome 120
Console 截圖: [附上截圖]
```

---

## 下一步

完成測試後，請告訴我：
1. 哪些測試通過 ✅
2. 哪些測試失敗 ❌
3. Console 中的關鍵訊息

我會根據測試結果進行進一步的修復。
